{% extends "base.html.j2" %}

{% from 'bootstrap5/form.html' import render_form, render_field, render_form_row, render_hidden_errors %}

{% block body %}


{% if results %}
<div class="d-flex justify-content-end">
    <button class="btn btn-secondary" type="button" data-bs-toggle="collapse" data-bs-target="#basic-search-form" aria-expanded="false" aria-controls="collapseform">
    Show/hide filters
  </button>
</div>
{%endif%}
<form method="post" action="{{ url_for('basic_search_bp.catalog_search')}}" id="basic-search-form" {% if results %} class="collapse" {% endif %}>
    {{ search_form.csrf_token }}

    {{ render_form_row([search_form.item_name.item_type, search_form.item_name.comparison, search_form.item_name.item_name],
        col_map = {'item_name-item_type': 'col-md-3', 'item_name-comparison' : 'col-md-2'}
        )}}
    <div class="row">
        <div class="col-md-6">
            <h5>Created</h5>
            {{ render_form_row([search_form.create_date.comparison, search_form.create_date.date])}}
        </div>
        <div class="col-md-6">
            <h5>Modified</h5>
            {{ render_form_row([search_form.mod_date.comparison, search_form.mod_date.date])}}
        </div>
    </div>
    <h4>Metadata</h4>
    {% for avu in search_form.avus %}

        {{ render_form_row(
            [avu.meta_a, avu.meta_v, avu.meta_u],
            col_map = {"avus-"~loop.index0~"-meta_a": 'col-md-4',
                "avus-"~loop.index0~"-meta_v" : 'col-md-6',
                "avus-"~loop.index0~"-meta_u": 'col-md-2'}
            ) }}
    {% endfor %}

    {{ render_field(search_form.submit) }}

</form>

{{ render_hidden_errors(search_form) }}

{# {{ pformat(results) }} #}
{# {{ render_form(search_form, form_type='horizonthal') }} #}

{{results.length}}

{% if results|length > 0 %}
<h4 class="mt-3">Results</h4>
<table>
    <thead>
        <tr>
        <th>Item</th>
        <th>Size</th>
        </tr>
    </thead>
    <tbody>
    {% for result in results.rows %}
    <tr><td>
        {{ result.values()[0]~result.values()[1] }}</td><td>
    {% endfor %}
    </tbody>
</table>
    {% for result in results.rows %}
    <li>
        {{ result.values() }}
    </li>
    {% endfor %}

{% endif %}

{% if search_time is defined %}
    <p> Searching took {{search_time }} seconds </p>
{% endif %}
{# {{ collection_tree }} #}

{% endblock body %}